<loading-indicator></loading-indicator>

<div class="pageTitle">
  <h2>
    <i class="bi bi-search"></i>
    å°ˆæ¡ˆå¯„ä»¶æ•¸æŸ¥è©¢
  </h2>
</div>
<collapsible-section
  [id]="'QueryProjectMailCount'"
  title="ğŸ” æŸ¥è©¢æ¢ä»¶"
  tooltipText="è«‹è¼¸å…¥å°æ‡‰æ¢ä»¶æŸ¥è©¢ã€‚(Enter å¯ç›´æ¥æŸ¥è©¢)"
>
  <!-- è‡ªè¨‚è¡¨å–® -->
  <div [formGroup]="validateForm">
    <div class="row">
      <search-select
        title="éƒ¨é–€"
        class="col-lg-6 col-sm-12 col-xs-12"
        [form]="validateForm"
        ctlName="department"
        placeholder="è«‹è¼¸å…¥æ”¶å°‹"
        [options]="departmentList"
      >
      </search-select>
      <date-range
        class="col-lg-6 col-sm-12 col-xs-12"
        titleStart="èµ·æ—¥"
        titleEnd="è¿„æ—¥"
        [form]="validateForm"
      ></date-range>
    </div>

    <div class="row">
      <div class="col-12">
        <button
          [disabled]="validateForm.invalid"
          (click)="Search()"
          class="btn btn-primary"
          type="button"
        >
          <i class="bi bi-search"></i> æœå°‹
        </button>
      </div>
    </div>
  </div>
</collapsible-section>

<!-- ag-gridè¡¨å–® -->
<collapsible-section
  [id]="'SearchProjectMailCount'"
  title="ğŸ“‹ åŠæ™‚æŸ¥çœ‹"
  tooltipText="é»æ“Šæ¬„ä½å…©ä¸‹ï¼Œå¯ä»¥è¤‡è£½è©²æ¬„ä½è³‡æ–™"
>
  <div class="row">
    <div
      style="margin-bottom: 12px"
      class="d-flex justify-content-end align-items-center gap-2"
    >
      <button
        [disabled]="!rowData || rowData.length == 0"
        (click)="DownloadCsv()"
        class="btn btn-success"
        type="button"
      >
        <i class="bi bi-file-earmark-arrow-up"></i> åŒ¯å‡º
      </button>
    </div>
  </div>

  <div class="row">
    <ag-grid-angular
      #agGrid
      style="width: 100%; height: 500px"
      class="ag-theme-alpine"
      [rowData]="rowData"
      [columnDefs]="columnDefs"
      [defaultColDef]="defaultColDef"
      [pagination]="false"
      [animateRows]="true"
      (sortChanged)="onSortChanged()"
      (filterChanged)="onFilterChanged()"
      (cellDoubleClicked)="onCellDoubleClicked($event)"
    >
    </ag-grid-angular>
    <!-- (gridReady)="onGridReady($event)" -->

    <div
      style="margin-top: 10px"
      class="d-flex justify-content-center align-items-center gap-2"
    >
      <button
        class="btn btn-primary"
        (click)="onPageChange(1)"
        [disabled]="currentPage === 1"
      >
        First Page
      </button>
      <button
        class="btn btn-secondary"
        (click)="onPageChange(currentPage - 1)"
        [disabled]="currentPage === 1"
      >
        Previous
      </button>
      <span class="mx-2">Page {{ currentPage }} / {{ totalPages }}</span>
      <button
        class="btn btn-secondary"
        (click)="onPageChange(currentPage + 1)"
        [disabled]="currentPage === totalPages"
      >
        Next
      </button>
      <button
        class="btn btn-primary"
        (click)="onPageChange(totalPages)"
        [disabled]="currentPage === totalPages"
      >
        Last Page
      </button>
    </div>
  </div>
</collapsible-section>
